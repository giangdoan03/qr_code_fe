import{j as D,r as d,i as p,e as t,a as u,w as l,n as f,k as x,b as c,h as g,l as b,F as C,t as E}from"./index-C2Vbri2L.js";const M=D.create({baseURL:"https://api-qrcode.labit365.com/api",withCredentials:!0}),N=(h={})=>M.get("/customers",{params:h}),j=["src"],B={__name:"CustomerList",setup(h){const y=d([]),v=d(!1),e=d({name:"",phone:"",email:"",city:"",dateRange:[]}),o=d({current:1,pageSize:10,total:0}),T=[{title:"STT",key:"stt"},{title:"Ảnh",key:"avatar",dataIndex:"avatar"},{title:"Tên khách hàng",key:"name",dataIndex:"name"},{title:"Số điện thoại",key:"phone",dataIndex:"phone"},{title:"Địa chỉ",key:"address",dataIndex:"address"},{title:"Tỉnh thành",key:"city",dataIndex:"city"},{title:"Email",key:"email",dataIndex:"email"},{title:"Ngày tương tác mới nhất",key:"last_interaction",dataIndex:"last_interaction"}],m=async()=>{v.value=!0;try{const i={page:o.value.current,per_page:o.value.pageSize,search:e.value.name,phone:e.value.phone,email:e.value.email,city:e.value.city,from:e.value.dateRange[0]?f(e.value.dateRange[0]).format("YYYY-MM-DD"):void 0,to:e.value.dateRange[1]?f(e.value.dateRange[1]).format("YYYY-MM-DD"):void 0},a=await N(i);y.value=a.data.data,o.value.total=a.data.pager.total}catch{x.error("Không thể tải danh sách khách hàng")}finally{v.value=!1}},w=i=>{o.value.current=i.current,o.value.pageSize=i.pageSize,m()},S=()=>{x.info("Đang phát triển chức năng export...")};return m(),(i,a)=>{const R=u("a-page-header"),r=u("a-input"),s=u("a-col"),Y=u("a-range-picker"),_=u("a-button"),I=u("a-row"),U=u("a-table");return c(),p("div",null,[t(R,{title:"Quản lý khách hàng"}),t(I,{gutter:[16,16],style:{"margin-bottom":"16px"}},{default:l(()=>[t(s,{span:4},{default:l(()=>[t(r,{value:e.value.name,"onUpdate:value":a[0]||(a[0]=n=>e.value.name=n),placeholder:"Tên khách hàng"},null,8,["value"])]),_:1}),t(s,{span:4},{default:l(()=>[t(r,{value:e.value.phone,"onUpdate:value":a[1]||(a[1]=n=>e.value.phone=n),placeholder:"Số điện thoại"},null,8,["value"])]),_:1}),t(s,{span:4},{default:l(()=>[t(r,{value:e.value.email,"onUpdate:value":a[2]||(a[2]=n=>e.value.email=n),placeholder:"Email"},null,8,["value"])]),_:1}),t(s,{span:4},{default:l(()=>[t(r,{value:e.value.city,"onUpdate:value":a[3]||(a[3]=n=>e.value.city=n),placeholder:"Tỉnh/TP"},null,8,["value"])]),_:1}),t(s,{span:6},{default:l(()=>[t(Y,{value:e.value.dateRange,"onUpdate:value":a[4]||(a[4]=n=>e.value.dateRange=n),style:{width:"100%"}},null,8,["value"])]),_:1}),t(s,{span:2},{default:l(()=>[t(_,{type:"primary",block:"",onClick:m},{default:l(()=>a[5]||(a[5]=[g("Tìm kiếm")])),_:1})]),_:1})]),_:1}),t(_,{onClick:S,style:{"margin-bottom":"12px"}},{default:l(()=>a[6]||(a[6]=[g("Export")])),_:1}),t(U,{columns:T,"data-source":y.value,loading:v.value,"row-key":"id",pagination:o.value,onChange:w},{bodyCell:l(({column:n,record:k,index:z})=>[n.key==="avatar"?(c(),p(C,{key:0},[k.avatar?(c(),p("img",{key:0,src:k.avatar,alt:"avatar",style:{width:"50px",height:"50px","object-fit":"cover"}},null,8,j)):b("",!0)],64)):n.key==="stt"?(c(),p(C,{key:1},[g(E((o.value.current-1)*o.value.pageSize+z+1),1)],64)):b("",!0)]),_:1},8,["data-source","loading","pagination"])])}}};export{B as default};
